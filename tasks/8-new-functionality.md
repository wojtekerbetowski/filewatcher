Add a new functionality and add it to all of the cases:

* option to override the snapshot if exists
* add an option to choose a shashing mechanism (e.g. sha256, md5)
* add option to choose snaphot format (json, csv)
